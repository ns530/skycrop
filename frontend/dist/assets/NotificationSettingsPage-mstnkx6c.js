var T=Object.defineProperty,$=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var v=(s,i,n)=>i in s?T(s,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[i]=n,o=(s,i)=>{for(var n in i||(i={}))H.call(i,n)&&v(s,n,i[n]);if(N)for(var n of N(i))R.call(i,n)&&v(s,n,i[n]);return s},l=(s,i)=>$(s,q(i));var j=(s,i,n)=>new Promise((p,c)=>{var h=r=>{try{b(n.next(r))}catch(f){c(f)}},d=r=>{try{b(n.throw(r))}catch(f){c(f)}},b=r=>r.done?p(r.value):Promise.resolve(r.value).then(h,d);b((n=n.apply(s,i)).next())});import{r as g}from"./chart-vendor-C7uCl44m.js";
import{j as e}from"./feature-admin-Bw8S4RZv.js";import{z as a,u as Y,C as x,B as w}from"./shared-B32_tFWT.js";import"./query-vendor-B8e9_Lvn.js";import"./router-vendor-D1DOKBjT.js";import"./map-vendor-BIpNu-NE.js";import"./feature-fields-fUbMVOqT.js";import"./feature-yield-DIh4ls_q.js";import"./http-vendor-DnTtldoj.js";const F=()=>{const[s,i]=g.useState(a.getPreferences()),[n,p]=g.useState(a.getPermission()),[c,h]=g.useState(!1),{showToast:d}=Y();g.useEffect(()=>{i(a.getPreferences()),p(a.getPermission())},[]);const b=()=>j(void 0,null,function*(){h(!0);try{const t=yield a.requestPermission();p(t),t==="granted"?(d({title:"Notifications enabled",description:"You will now receive important alerts.",variant:"success"}),i(a.getPreferences())):d({title:"Permission denied",description:"You can enable notifications in your browser settings.",variant:"error"})}catch(t){d({title:"Error",description:"Could not request notification permission.",variant:"error"})}finally{h(!1)}}),r=()=>{if(!s.enabled&&n!=="granted")b();else{const t=l(o({},s),{enabled:!s.enabled});i(t),a.savePreferences(t),d({title:t.enabled?"Notifications enabled":"Notifications disabled",description:t.enabled?"You will receive important alerts.":"Notifications have been turned off.",variant:t.enabled?"success":"default"})}},f=t=>{const m=l(o({},s.types),{[t]:!s.types[t]}),u=l(o({},s),{types:m});i(u),a.savePreferences(u)},P=()=>{const t=l(o({},s),{doNotDisturb:!s.doNotDisturb});i(t),a.savePreferences(t),d({title:t.doNotDisturb?"Do Not Disturb enabled":"Do Not Disturb disabled",description:t.doNotDisturb?"Only critical notifications will be shown.":"All notifications will be shown.",variant:"default"})},S=()=>{const t=l(o({},s),{soundEnabled:!s.soundEnabled});i(t),a.savePreferences(t)},E=()=>{const t=l(o({},s),{vibrationEnabled:!s.vibrationEnabled});i(t),a.savePreferences(t)},y=(t,m)=>{const u=l(o({},s),{[t]:m});i(u),a.savePreferences(u)},k=()=>{a.send({type:"system",priority:"low",title:"ðŸ”” Test Notification",body:"This is a test notification from SkyCrop. If you see this, notifications are working!"})},C=[{type:"health-alert",label:"Health Alerts",description:"Critical field health issues"},{type:"weather-warning",label:"Weather Warnings",description:"Severe weather alerts"},{type:"recommendation",label:"AI Recommendations",description:"New recommendations from AI"},{type:"yield-update",label:"Yield Updates",description:"Yield prediction changes"},{type:"system",label:"System Messages",description:"Important system updates"},{type:"general",label:"General News",description:"General updates and news"}],D=a.isSupported();return e.jsxs("section",{"aria-labelledby":"notification-settings-heading",className:"space-y-6",children:[e.jsxs("header",{className:"space-y-2",children:[e.jsx("h1",{id:"notification-settings-heading",className:"text-2xl font-bold text-gray-900",children:"ðŸ”” Notification Settings"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage how and when you receive notifications from SkyCrop"})]}),!D&&e.jsx(x,{children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-4xl mb-3",children:"âš ï¸"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Notifications not supported"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Your browser does not support push notifications. Please use a modern browser like Chrome, Firefox, or Safari."})]})}),e.jsx(x,{title:"Enable Notifications",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Master switch"}),e.jsx("p",{className:"text-xs text-gray-600",children:n==="denied"?"Permission denied. Enable in browser settings.":"Turn all notifications on or off"})]}),e.jsx("button",{type:"button",onClick:r,disabled:n==="denied"||c,className:`
                relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2
                ${s.enabled?"bg-blue-600":"bg-gray-200"}
                ${n==="denied"||c?"opacity-50 cursor-not-allowed":"cursor-pointer"}
              `,children:e.jsx("span",{className:`
                  inline-block h-4 w-4 transform rounded-full bg-white transition-transform
                  ${s.enabled?"translate-x-6":"translate-x-1"}
                `})})]}),n==="default"&&!s.enabled&&e.jsx(w,{onClick:b,disabled:c,size:"sm",className:"w-full sm:w-auto",children:c?"Requesting...":"Enable Notifications"}),s.enabled&&e.jsx(w,{onClick:k,variant:"secondary",size:"sm",className:"w-full sm:w-auto",children:"Send Test Notification"})]})}),e.jsx(x,{title:"Notification Types",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"Choose which types of notifications you want to receive"}),C.map(({type:t,label:m,description:u})=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:m}),e.jsx("p",{className:"text-xs text-gray-600",children:u})]}),e.jsx("button",{type:"button",onClick:()=>f(t),disabled:!s.enabled,className:`
                  relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                  focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2
                  ${s.types[t]?"bg-blue-600":"bg-gray-200"}
                  ${s.enabled?"cursor-pointer":"opacity-50 cursor-not-allowed"}
                `,children:e.jsx("span",{className:`
                    inline-block h-4 w-4 transform rounded-full bg-white transition-transform
                    ${s.types[t]?"translate-x-6":"translate-x-1"}
                  `})})]},t))]})}),e.jsx(x,{title:"Do Not Disturb",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Do Not Disturb mode"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Only show critical notifications"})]}),e.jsx("button",{type:"button",onClick:P,disabled:!s.enabled,className:`
                relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2
                ${s.doNotDisturb?"bg-blue-600":"bg-gray-200"}
                ${s.enabled?"cursor-pointer":"opacity-50 cursor-not-allowed"}
              `,children:e.jsx("span",{className:`
                  inline-block h-4 w-4 transform rounded-full bg-white transition-transform
                  ${s.doNotDisturb?"translate-x-6":"translate-x-1"}
                `})})]}),e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Quiet Hours"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Don't send non-critical notifications during these hours"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Start time"}),e.jsx("input",{type:"time",value:s.quietHoursStart||"22:00",onChange:t=>y("quietHoursStart",t.target.value),disabled:!s.enabled,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-brand-blue focus:outline-none focus:ring-1 focus:ring-brand-blue disabled:opacity-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"End time"}),e.jsx("input",{type:"time",value:s.quietHoursEnd||"07:00",onChange:t=>y("quietHoursEnd",t.target.value),disabled:!s.enabled,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-brand-blue focus:outline-none focus:ring-1 focus:ring-brand-blue disabled:opacity-50"})]})]})]})]})}),e.jsx(x,{title:"Sound & Vibration",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Sound"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Play sound with notifications"})]}),e.jsx("button",{type:"button",onClick:S,disabled:!s.enabled,className:`
                relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2
                ${s.soundEnabled?"bg-blue-600":"bg-gray-200"}
                ${s.enabled?"cursor-pointer":"opacity-50 cursor-not-allowed"}
              `,children:e.jsx("span",{className:`
                  inline-block h-4 w-4 transform rounded-full bg-white transition-transform
                  ${s.soundEnabled?"translate-x-6":"translate-x-1"}
                `})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Vibration"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Vibrate on mobile devices"})]}),e.jsx("button",{type:"button",onClick:E,disabled:!s.enabled,className:`
                relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2
                ${s.vibrationEnabled?"bg-blue-600":"bg-gray-200"}
                ${s.enabled?"cursor-pointer":"opacity-50 cursor-not-allowed"}
              `,children:e.jsx("span",{className:`
                  inline-block h-4 w-4 transform rounded-full bg-white transition-transform
                  ${s.vibrationEnabled?"translate-x-6":"translate-x-1"}
                `})})]})]})})]})};export{F as NotificationSettingsPage,F as default};

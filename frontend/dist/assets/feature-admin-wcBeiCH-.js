var je=Object.defineProperty,be=Object.defineProperties;var ve=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var se=(s,t,a)=>t in s?je(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,ae=(s,t)=>{for(var a in t||(t={}))Ne.call(t,a)&&se(s,a,t[a]);if(te)for(var a of te(t))we.call(t,a)&&se(s,a,t[a]);return s},ne=(s,t)=>be(s,ve(t));var v=(s,t,a)=>new Promise((i,r)=>{var u=d=>{try{x(a.next(d))}catch(h){r(h)}},g=d=>{try{x(a.throw(d))}catch(h){r(h)}},x=d=>d.done?i(d.value):Promise.resolve(d.value).then(u,g);x((a=a.apply(s,t)).next())});import{u as J,c as de,d as oe,r as C,j as e}from"./react-vendor-CXQW5CXM.js";import{h as _,n as I,a as X,u as E,C as p,B as o,M as W}from"./shared-BOarZger.js";const xe="/admin/users",G="/admin/content",Se="/admin/system-status",me=s=>{if(!s)return;const t={};return typeof s.page=="number"&&(t.page=s.page),typeof s.pageSize=="number"&&(t.pageSize=s.pageSize),s.search&&(t.search=s.search),s.sort&&(t.sort=s.sort),s.order&&(t.order=s.order),t},ue=s=>{var t,a;return{id:s.id,name:s.name,email:s.email,role:s.role,status:(t=s.status)!=null?t:"active",lastActiveAt:(a=s.last_active_at)!=null?a:void 0}},he=s=>{var t,a;return{id:s.id,title:s.title,summary:s.summary,body:s.body,status:(t=s.status)!=null?t:"draft",publishedAt:(a=s.published_at)!=null?a:void 0}},Ce=s=>({mlService:s.ml_service,api:s.api,satelliteIngest:s.satellite_ingest}),Ae=s=>v(void 0,null,function*(){try{const t=yield _.get(xe,{params:me(s)}),{data:a,pagination:i,meta:r}=t.data;return{data:a.map(ue),pagination:{page:i.page,pageSize:i.pageSize,total:i.total},meta:r}}catch(t){throw I(t)}}),ke=(s,t)=>v(void 0,null,function*(){try{const a=yield _.patch(`${xe}/${s}/status`,{status:t});return ue(a.data.data)}catch(a){throw I(a)}}),Pe=s=>v(void 0,null,function*(){try{const t=yield _.get(G,{params:me(s)}),{data:a,pagination:i,meta:r}=t.data;return{data:a.map(he),pagination:{page:i.page,pageSize:i.pageSize,total:i.total},meta:r}}catch(t){throw I(t)}}),Te=s=>v(void 0,null,function*(){try{const t={title:s.title,summary:s.summary,body:s.body,status:s.status,published_at:s.publishedAt},a=!!s.id,i=a?"put":"post",r=a?`${G}/${s.id}`:G,u=yield _[i](r,t);return he(u.data.data)}catch(t){throw I(t)}}),ze=()=>v(void 0,null,function*(){try{const s=yield _.get(Se);return Ce(s.data.data)}catch(s){throw I(s)}}),pe=s=>J({queryKey:X.users(s),queryFn:()=>Ae(s),placeholderData:t=>t}),Ue=()=>{const s=de();return oe({mutationFn:({id:t,status:a})=>ke(t,a),onSuccess:()=>{s.invalidateQueries({queryKey:["admin","users"]})}})},ge=s=>J({queryKey:X.content(s),queryFn:()=>Pe(s),placeholderData:t=>t}),Fe=()=>{const s=de();return oe({mutationFn:t=>Te(t),onSuccess:()=>{s.invalidateQueries({queryKey:["admin","content"]})}})},ye=()=>J({queryKey:X.systemStatus,queryFn:()=>ze(),staleTime:3e4}),O=s=>{switch(s){case"up":return"excellent";case"degraded":return"fair";case"down":return"poor";default:return"default"}},B=s=>{switch(s){case"up":return"OK";case"degraded":return"Degraded";case"down":return"Down";default:return"Unknown"}},H=s=>{switch(s){case"up":return"inline-flex items-center rounded-full bg-status-excellent/10 px-2 py-0.5 text-xs font-medium text-status-excellent";case"degraded":return"inline-flex items-center rounded-full bg-status-fair/10 px-2 py-0.5 text-xs font-medium text-status-fair";case"down":return"inline-flex items-center rounded-full bg-status-poor/10 px-2 py-0.5 text-xs font-medium text-status-poor";default:return"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-500"}},ie=()=>{var c;const{showToast:s}=E(),{data:t,isLoading:a,isError:i,error:r,refetch:u,isFetching:g}=ye(),{data:x,isLoading:d}=pe({page:1,pageSize:1}),{data:h,isLoading:y}=ge({page:1,pageSize:1}),N=C.useMemo(()=>{if(!(!x||d))return x.pagination.total},[x,d]),S=C.useMemo(()=>{if(!(!h||y))return h.pagination.total},[h,y]),m=()=>v(void 0,null,function*(){var T;try{yield u(),s({title:"System status refreshed",variant:"success"})}catch(M){const k=r!=null?r:M;s({title:"Failed to refresh system status",description:(T=k==null?void 0:k.message)!=null?T:"Something went wrong while checking system status.",variant:"error"})}}),A=()=>a&&!t?e.jsx("p",{className:"text-sm text-gray-500",children:"Checking system status…"}):i&&!t?e.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[e.jsx("p",{className:"text-red-600",children:"Unable to load system status."}),e.jsx(o,{size:"sm",variant:"secondary",onClick:m,children:"Retry"})]}):t?e.jsxs("dl",{className:"grid grid-cols-1 gap-2 text-sm sm:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("dt",{className:"text-gray-600",children:"API"}),e.jsx("dd",{className:H(t.api),children:B(t.api)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("dt",{className:"text-gray-600",children:"ML service"}),e.jsx("dd",{className:H(t.mlService),children:B(t.mlService)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("dt",{className:"text-gray-600",children:"Satellite ingest"}),e.jsx("dd",{className:H(t.satelliteIngest),children:B(t.satelliteIngest)})]})]}):e.jsx("p",{className:"text-sm text-gray-500",children:"System status is currently unavailable."});return e.jsxs("section",{"aria-labelledby":"admin-overview-heading",className:"space-y-4",children:[e.jsxs("header",{className:"space-y-1",children:[e.jsx("h1",{id:"admin-overview-heading",className:"text-lg font-semibold text-gray-900",children:"Admin overview"}),e.jsx("p",{className:"text-sm text-gray-600",children:"System status and key metrics for SkyCrop. Use this dashboard to monitor platform health and activity."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsxs(p,{title:"Active farmers",showStatusStripe:!0,status:"excellent",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:N!=null?N:"—"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Approximated using total user count. Filtering by role/status will be wired in a future iteration."})]}),e.jsxs(p,{title:"Fields monitored",showStatusStripe:!0,status:"fair",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:"—"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Placeholder metric. Will be derived from field inventories in a future iteration."})]}),e.jsxs(p,{title:"Content items",showStatusStripe:!0,status:"excellent",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:S!=null?S:"—"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Total news and articles currently managed in the system."})]}),e.jsxs(p,{title:"System health",showStatusStripe:!0,status:O(t==null?void 0:t.api),children:[A(),g&&e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Refreshing status…"})]})]}),e.jsxs(p,{title:"Detailed system status",className:"mt-2",children:[a&&!t&&e.jsx("p",{className:"text-sm text-gray-500",children:"Checking system status…"}),i&&!t&&e.jsxs("div",{className:"flex flex-col gap-3 text-sm",children:[e.jsxs("p",{className:"text-red-600",children:["Unable to load system status: ",(c=r==null?void 0:r.message)!=null?c:"Unknown error","."]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsx(o,{size:"sm",variant:"secondary",onClick:m,children:"Retry"})})]}),!a&&!i&&t&&e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(p,{title:"API",status:O(t.api),showStatusStripe:!0,className:"border-0 shadow-none",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[t.api==="up"&&"Core APIs are responding within expected latency.",t.api==="degraded"&&"API is degraded. Expect slower responses and occasional timeouts.",t.api==="down"&&"API is currently unavailable. Farmers may not be able to access latest data."]})}),e.jsx(p,{title:"ML service",status:O(t.mlService),showStatusStripe:!0,className:"border-0 shadow-none",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[t.mlService==="up"&&"Model predictions for health and yield are running normally.",t.mlService==="degraded"&&"ML service is degraded. Recommendations may be slower than usual.",t.mlService==="down"&&"ML service is unavailable. Health insights and recommendations may be stale."]})}),e.jsx(p,{title:"Satellite ingest",status:O(t.satelliteIngest),showStatusStripe:!0,className:"border-0 shadow-none",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[t.satelliteIngest==="up"&&"Satellite scenes are being ingested and processed as expected.",t.satelliteIngest==="degraded"&&"Satellite ingest is degraded. Expect delays before new imagery appears.",t.satelliteIngest==="down"&&"Satellite ingest is down. New acquisitions will not be processed until this is resolved."]})})]})]}),e.jsx(p,{title:"Quick admin actions",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(o,{size:"sm",variant:"primary",children:"Manage users"}),e.jsx(o,{size:"sm",variant:"secondary",children:"Review content"}),e.jsx(o,{size:"sm",variant:"ghost",onClick:m,children:"Refresh system status"})]})})]})},De=Object.freeze(Object.defineProperty({__proto__:null,AdminOverviewPage:ie,default:ie},Symbol.toStringTag,{value:"Module"})),Me=s=>{if(!s)return"—";const t=new Date(s);return Number.isNaN(t.getTime())?s:t.toLocaleString()},re=()=>{var D,U;const{showToast:s}=E(),[t,a]=C.useState("all"),[i,r]=C.useState("all"),{data:u,isLoading:g,isError:x,error:d,refetch:h,isFetching:y}=pe({page:1,pageSize:50}),N=(D=u==null?void 0:u.data)!=null?D:[],S=C.useMemo(()=>N.filter(l=>{const f=t==="all"?!0:l.role.toLowerCase()===t,b=i==="all"?!0:l.status===i;return f&&b}),[N,t,i]),{mutateAsync:m,isPending:A}=Ue(),[c,T]=C.useState(null),M=(l,f)=>{T({user:l,nextStatus:f})},k=()=>{T(null)},L=()=>v(void 0,null,function*(){var l;try{yield h()}catch(f){const b=d!=null?d:f;s({title:"Failed to load users",description:(l=b==null?void 0:b.message)!=null?l:"Something went wrong while fetching users.",variant:"error"})}}),z=()=>v(void 0,null,function*(){var l;if(c)try{yield m({id:c.user.id,status:c.nextStatus}),s({title:"User status updated",description:`${c.user.email} is now ${c.nextStatus}.`,variant:"success"}),k()}catch(f){const b=f;s({title:"Failed to update user",description:(l=b==null?void 0:b.message)!=null?l:"Something went wrong while updating the user status.",variant:"error"})}}),$=l=>l==="active"?e.jsx("span",{className:"inline-flex items-center rounded-full bg-status-excellent/10 px-2 py-0.5 text-xs font-medium text-status-excellent",children:"Active"}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-500",children:"Disabled"}),q=l=>{const f=l.status==="active",b=f?"disabled":"active";return e.jsxs("tr",{className:"hover:bg-gray-50 text-gray-900",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:l.name}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-700",children:l.email}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 capitalize",children:l.role}),e.jsx("td",{className:"px-4 py-3 text-xs",children:$(l.status)}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-600",children:Me(l.lastActiveAt)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx(o,{size:"sm",variant:f?"secondary":"primary",onClick:()=>M(l,b),children:f?"Disable":"Enable"})})]},l.id)};return e.jsxs("section",{"aria-labelledby":"admin-users-heading",className:"space-y-4",children:[e.jsx("header",{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{id:"admin-users-heading",className:"text-lg font-semibold text-gray-900",children:"User management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View and manage farmer and admin accounts."})]})}),e.jsxs(p,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 border-b border-gray-100 pb-3 mb-3 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"Role"}),e.jsxs("select",{value:t,onChange:l=>a(l.target.value),className:"inline-flex h-8 rounded-md border border-gray-200 bg-white px-2 text-xs text-gray-800 shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-blue",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"farmer",children:"Farmer"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"Status"}),e.jsxs("select",{value:i,onChange:l=>r(l.target.value),className:"inline-flex h-8 rounded-md border border-gray-200 bg-white px-2 text-xs text-gray-800 shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-blue",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"disabled",children:"Disabled"})]})]}),e.jsx("div",{className:"ml-auto text-gray-500",children:y?"Refreshing users…":`Total users: ${(U=u==null?void 0:u.pagination.total)!=null?U:0}`})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-100 text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Name"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Email"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Role"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Status"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Last active"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[g&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-sm text-gray-500",children:"Loading users…"})}),!g&&x&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-sm text-red-600",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("p",{children:"Unable to load users."}),e.jsx(o,{size:"sm",variant:"secondary",onClick:L,children:"Retry"})]})})}),!g&&!x&&S.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-sm text-gray-500",children:"No users match the selected filters."})}),!g&&!x&&S.map(q)]})]})})]}),e.jsx(W,{isOpen:!!c,onClose:k,title:"Change user status",children:c&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:["You are about to change the status for"," ",e.jsx("span",{className:"font-medium",children:c.user.email})," to"," ",e.jsx("span",{className:"font-medium",children:c.nextStatus}),"."]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Disabled users will not be able to sign in or access the platform until re-enabled."}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(o,{size:"sm",variant:"secondary",onClick:k,disabled:A,children:"Cancel"}),e.jsx(o,{size:"sm",variant:"primary",onClick:z,disabled:A,children:A?"Updating…":"Confirm"})]})]})})]})},Re=Object.freeze(Object.defineProperty({__proto__:null,AdminUsersPage:re,default:re},Symbol.toStringTag,{value:"Module"})),K=s=>s?{id:s.id,title:s.title,summary:s.summary,body:s.body,status:s.status}:{id:void 0,title:"",summary:"",body:"",status:"draft"},le=()=>{var Z,ee;const{showToast:s}=E(),{data:t,isLoading:a,isError:i,error:r,refetch:u,isFetching:g}=ge({page:1,pageSize:50}),x=(Z=t==null?void 0:t.data)!=null?Z:[],d=(ee=t==null?void 0:t.pagination.total)!=null?ee:0,{mutateAsync:h,isPending:y}=Fe(),[N,S]=C.useState(!1),[m,A]=C.useState(()=>K()),[c,T]=C.useState(null),M=()=>{A(K()),S(!0)},k=n=>{A(K(n)),S(!0)},L=()=>{y||S(!1)},z=n=>j=>{const w=j.target.value;A(P=>ne(ae({},P),{[n]:w}))},$=()=>v(void 0,null,function*(){var P;const n=m.title.trim(),j=m.summary.trim(),w=m.body.trim();if(!n||!j){s({title:"Missing required fields",description:"Title and summary are required to save content.",variant:"warning"});return}try{yield h({id:m.id,title:n,summary:j,body:w,status:m.status}),s({title:m.id?"Content updated":"Content created",variant:"success"}),S(!1)}catch(R){const F=R;s({title:"Failed to save content",description:(P=F==null?void 0:F.message)!=null?P:"Something went wrong while saving content.",variant:"error"})}}),q=()=>v(void 0,null,function*(){var n;try{yield u()}catch(j){const w=r!=null?r:j;s({title:"Failed to load content",description:(n=w==null?void 0:w.message)!=null?n:"Something went wrong while fetching content.",variant:"error"})}}),D=n=>{T(n)},U=()=>{T(null)},l=()=>v(void 0,null,function*(){var j;if(!c)return;const n=c.status==="published"?"draft":"published";try{yield h({id:c.id,status:n}),s({title:n==="published"?"Content published":"Content unpublished",variant:"success"}),U()}catch(w){const P=w;s({title:"Failed to update content status",description:(j=P==null?void 0:P.message)!=null?j:"Something went wrong while updating content.",variant:"error"})}}),f=C.useMemo(()=>[...x].sort((n,j)=>{var R,F;const w=(R=n.publishedAt)!=null?R:"";return((F=j.publishedAt)!=null?F:"").localeCompare(w)}),[x]),b=n=>n==="published"?e.jsx("span",{className:"inline-flex items-center rounded-full bg-status-excellent/10 px-2 py-0.5 text-xs font-medium text-status-excellent",children:"Published"}):e.jsx("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-500",children:"Draft"}),fe=n=>{if(!n)return"—";const j=new Date(n);return Number.isNaN(j.getTime())?n:j.toLocaleDateString()};return e.jsxs("section",{"aria-labelledby":"admin-content-heading",className:"space-y-4",children:[e.jsxs("header",{className:"flex flex-col gap-1 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{id:"admin-content-heading",className:"text-lg font-semibold text-gray-900",children:"Content management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage news and articles shown to farmers."})]}),e.jsx(o,{size:"sm",variant:"primary",onClick:M,children:"New content"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"flex items-center justify-between gap-2 border-b border-gray-100 pb-3 mb-3 text-xs text-gray-600",children:e.jsx("span",{children:g?"Refreshing content…":`Total items: ${d}`})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-100 text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Title"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Summary"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Status"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Published"}),e.jsx("th",{scope:"col",className:"px-4 py-2 text-xs font-semibold uppercase tracking-wide text-gray-500 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[a&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-sm text-gray-500",children:"Loading content…"})}),!a&&i&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-sm text-red-600",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("p",{children:"Unable to load content."}),e.jsx(o,{size:"sm",variant:"secondary",onClick:q,children:"Retry"})]})})}),!a&&!i&&f.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-sm text-gray-500",children:"No content items yet. Use New content to create the first announcement."})}),!a&&!i&&f.map(n=>e.jsxs("tr",{className:"hover:bg-gray-50 text-gray-900 align-top",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:n.title}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-700 max-w-md",children:e.jsx("span",{className:"line-clamp-2",children:n.summary})}),e.jsx("td",{className:"px-4 py-3 text-xs",children:b(n.status)}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-600",children:fe(n.publishedAt)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[e.jsx(o,{size:"sm",variant:"secondary",onClick:()=>k(n),children:"Edit"}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>D(n),children:n.status==="published"?"Unpublish":"Publish"})]})})]},n.id))]})]})})]}),e.jsx(W,{isOpen:N,onClose:L,title:m.id?"Edit content":"New content",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"content-title",className:"block text-xs font-medium text-gray-700",children:"Title"}),e.jsx("input",{id:"content-title",type:"text",value:m.title,onChange:z("title"),className:"block w-full rounded-md border border-gray-200 px-2 py-1.5 text-sm text-gray-900 shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-blue",placeholder:"Enter a clear headline"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"content-summary",className:"block text-xs font-medium text-gray-700",children:"Summary"}),e.jsx("input",{id:"content-summary",type:"text",value:m.summary,onChange:z("summary"),className:"block w-full rounded-md border border-gray-200 px-2 py-1.5 text-sm text-gray-900 shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-blue",placeholder:"Short description shown in lists"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"content-body",className:"block text-xs font-medium text-gray-700",children:"Body"}),e.jsx("textarea",{id:"content-body",value:m.body,onChange:z("body"),rows:6,className:"block w-full rounded-md border border-gray-200 px-2 py-1.5 text-sm text-gray-900 shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-blue",placeholder:"Full text (supports simple paragraphs; rich formatting to be added later)"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"content-status",className:"block text-xs font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"content-status",value:m.status,onChange:z("status"),className:"block w-full rounded-md border border-gray-200 bg-white px-2 py-1.5 text-sm text-gray-900 shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-blue",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(o,{size:"sm",variant:"secondary",onClick:L,disabled:y,children:"Cancel"}),e.jsx(o,{size:"sm",variant:"primary",onClick:$,disabled:y,children:y?"Saving…":"Save"})]})]})}),e.jsx(W,{isOpen:!!c,onClose:U,title:(c==null?void 0:c.status)==="published"?"Unpublish content":"Publish content",children:c&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:["You are about to ",c.status==="published"?"unpublish":"publish"," ",e.jsx("span",{className:"font-medium",children:c.title}),"."]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Published items may be visible to farmers in the mobile or web app, depending on configuration."}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(o,{size:"sm",variant:"secondary",onClick:U,disabled:y,children:"Cancel"}),e.jsx(o,{size:"sm",variant:"primary",onClick:l,disabled:y,children:y?"Updating…":"Confirm"})]})]})})]})},Oe=Object.freeze(Object.defineProperty({__proto__:null,AdminContentPage:le,default:le},Symbol.toStringTag,{value:"Module"})),Q=s=>{switch(s){case"up":return"excellent";case"degraded":return"fair";case"down":return"poor";default:return"default"}},Y=s=>{switch(s){case"up":return"inline-flex items-center rounded-full bg-status-excellent/10 px-2 py-0.5 text-xs font-medium text-status-excellent";case"degraded":return"inline-flex items-center rounded-full bg-status-fair/10 px-2 py-0.5 text-xs font-medium text-status-fair";case"down":return"inline-flex items-center rounded-full bg-status-poor/10 px-2 py-0.5 text-xs font-medium text-status-poor";default:return"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-500"}},V=s=>{switch(s){case"up":return"Up";case"degraded":return"Degraded";case"down":return"Down";default:return"Unknown"}},ce=()=>{var d;const{showToast:s}=E(),{data:t,isLoading:a,isError:i,error:r,refetch:u,isFetching:g}=ye(),x=()=>v(void 0,null,function*(){var h;try{yield u(),s({title:"System status refreshed",variant:"success"})}catch(y){const N=r!=null?r:y;s({title:"Failed to refresh system status",description:(h=N==null?void 0:N.message)!=null?h:"Something went wrong while refreshing system health.",variant:"error"})}});return e.jsxs("section",{"aria-labelledby":"admin-system-health-heading",className:"space-y-4",children:[e.jsxs("header",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{id:"admin-system-health-heading",className:"text-lg font-semibold text-gray-900",children:"System health"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Real-time view of API, ML, and satellite ingest status. Use this to understand how SkyCrop services are behaving."})]}),e.jsx(o,{size:"sm",variant:"secondary",onClick:x,disabled:g,children:g?"Refreshing…":"Refresh"})]}),e.jsxs(p,{children:[a&&!t&&e.jsx("p",{className:"text-sm text-gray-500",children:"Checking system status…"}),i&&!t&&e.jsxs("div",{className:"flex flex-col gap-3 text-sm",children:[e.jsxs("p",{className:"text-red-600",children:["Unable to load system status: ",(d=r==null?void 0:r.message)!=null?d:"Unknown error","."]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsx(o,{size:"sm",variant:"secondary",onClick:x,disabled:g,children:"Retry"})})]}),!a&&!i&&t&&e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(p,{title:"API",status:Q(t.api),showStatusStripe:!0,className:"border-0 shadow-none",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Status"}),e.jsx("span",{className:Y(t.api),children:V(t.api)})]}),e.jsx("p",{className:"text-sm text-gray-700",children:"The API provides all core platform capabilities including authentication, fields, health, and recommendations."}),t.api==="degraded"&&e.jsx("p",{className:"text-xs text-status-fair",children:"API is degraded. Expect slower responses and occasional timeouts for farmers."}),t.api==="down"&&e.jsx("p",{className:"text-xs text-status-poor",children:"API is down. Farmers may be unable to sign in or view updated field information."})]})}),e.jsx(p,{title:"ML service",status:Q(t.mlService),showStatusStripe:!0,className:"border-0 shadow-none",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Status"}),e.jsx("span",{className:Y(t.mlService),children:V(t.mlService)})]}),e.jsx("p",{className:"text-sm text-gray-700",children:"ML services power health indices, yield predictions, and recommendation models for farmer fields."}),t.mlService==="degraded"&&e.jsx("p",{className:"text-xs text-status-fair",children:"ML service is degraded. Health maps and recommendations may take longer to generate."}),t.mlService==="down"&&e.jsx("p",{className:"text-xs text-status-poor",children:"ML service is down. New health insights or recommendations may not be available and existing ones may be stale."})]})}),e.jsx(p,{title:"Satellite ingest",status:Q(t.satelliteIngest),showStatusStripe:!0,className:"border-0 shadow-none",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Status"}),e.jsx("span",{className:Y(t.satelliteIngest),children:V(t.satelliteIngest)})]}),e.jsx("p",{className:"text-sm text-gray-700",children:"Satellite ingest handles fetching, processing, and storing new imagery used for field monitoring."}),t.satelliteIngest==="degraded"&&e.jsx("p",{className:"text-xs text-status-fair",children:"Ingest is degraded. Expect delays before new satellite scenes appear in field views."}),t.satelliteIngest==="down"&&e.jsx("p",{className:"text-xs text-status-poor",children:"Ingest is down. No new imagery will be processed until this is resolved; health data may become outdated."})]})})]}),!a&&!i&&!t&&e.jsx("p",{className:"text-sm text-gray-500",children:"System status is currently unavailable."})]})]})},Ee=Object.freeze(Object.defineProperty({__proto__:null,AdminSystemHealthPage:ce,default:ce},Symbol.toStringTag,{value:"Module"}));export{De as A,Re as a,Oe as b,Ee as c};
